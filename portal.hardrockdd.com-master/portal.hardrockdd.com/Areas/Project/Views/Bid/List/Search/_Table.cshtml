@model portal.Areas.Project.Models.Bid.TrackerListViewModel
@{
    ViewBag.TableRow = "True";
    var tableId = string.Format("table_{0}", Guid.NewGuid());
    var viewOnly = bool.TryParse(ViewBag.ViewOnly?.ToString(), out bool viewOnlyOut) ? viewOnlyOut : false;
    string tableKey = "";
   
}
<table class="table"
       id="@tableId"
       data-dataurl="@Url.Action("BidSearchData","Bid")"       
       data-urlsearchreturn="@Url.Action("BidSearchReturn","Bid")"
       data-tablekey="@tableKey">
    <thead>
        <tr>
            <th data-datatable-filter-type="none">@Html.LabelForRequired(model => model.List.FirstOrDefault().BDCo)</th>
            <th data-datatable-filter-type="input">@Html.LabelForRequired(model => model.List.FirstOrDefault().BidId)</th>
            <th style="min-width:80px;" data-datatable-filter-type="multiselect">@Html.LabelForRequired(model => model.List.FirstOrDefault().Status)</th>
            <th style="min-width:80px;" data-datatable-filter-type="none">@Html.LabelForRequired(model => model.List.FirstOrDefault().BidDate)</th>
            <th style="min-width:80px;" data-datatable-filter-type="none">@Html.LabelForRequired(model => model.List.FirstOrDefault().StartDate)</th>
            <th style="min-width:120px;" data-datatable-filter-type="select">@Html.LabelForRequired(model => model.List.FirstOrDefault().FirmName)</th>
            <th style="min-width:120px;" data-datatable-filter-type="select">@Html.LabelForRequired(model => model.List.FirstOrDefault().Customer)</th>
            <th style="min-width:150px;" data-datatable-filter-type="input">@Html.LabelForRequired(model => model.List.FirstOrDefault().Description)</th>
            <th style="min-width:80px;" data-datatable-filter-type="select">@Html.LabelForRequired(model => model.List.FirstOrDefault().Division)</th>
            <th style="min-width:60px;" data-datatable-filter-type="input">@Html.LabelForRequired(model => model.List.FirstOrDefault().PipeSize)</th>
            <th style="min-width:60px;" data-datatable-filter-type="input">@Html.LabelForRequired(model => model.List.FirstOrDefault().Footage)</th>
            <th style="min-width:80px;" data-datatable-filter-type="select">@Html.LabelForRequired(model => model.List.FirstOrDefault().CreatedUser)</th>
            <th data-datatable-filter-type="none">@Html.LabelForRequired(model => model.List.FirstOrDefault().SearchString)</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>
<script>
    $(document).ready(function () {
        var itemCnt = @(Model.List.Count());
        $('#@tableId').DataTable({
            autoWidth: false,
            paging: true,
            lengthMenu: [[25, 50, 100, -1], [25, 50, 100, "All"]],
            pageLength: 25,
            ordering: true,
            processing: true,
            scrollY: 400,
            scrollX: true,
            'language': {
                'loadingRecords': 'Loading....',
                'processing': '<span class="spinner-small"></span>'
            },
            ajax: {
                "url": $('#@tableId').data('dataurl'),
                "type": "GET",
                "datatype": "json",
            },
            order: [
                [1, "desc"]
            ],
            columns: [
                { data: "BDCo", visible: false },
                { data: "BidId" },
                { data: "StatusString" },
                {
                    data: "BidDate",
                    render: function (data, type) {
                        //console.log(type, data);
                        return type === 'sort' ? moment(data).format("YYYY-MM-DD") : moment(data).format('L');
                    }
                },
                {
                    data: "StartDate",
                    render: function (data, type) {
                        //console.log(type, data);
                        return type === 'sort' ? moment(data).format("YYYY-MM-DD") : moment(data).format('L');
                    }
                },
                { data: "FirmName" },
                { data: "Customer" },
                { data: "Description" },
                { data: "Division" },
                { data: "PipeSize", render: $.fn.dataTable.render.number(',', '.', 2, '') },
                { data: "Footage", render: $.fn.dataTable.render.number(',', '.', 0, '') },
                { data: "CreatedUser" },
                { data: "SearchString", visible: false },
            ],
            fnInitComplete: function () {
                Table().init($('#@tableId'));
            },
            columnDefs: [
                {
                    targets: [2],
                    createdCell: function (cell, cellData, rowData, rowIndex, colIndex) {
                        $(cell).html('<span class="label ' + rowData.StatusClass + '">' + cellData + '</span>');
                    }
                },
                {
                    targets: [9, 10],
                    createdCell: function (cell, cellData, rowData, rowIndex, colIndex) {
                        $(cell).html('<span class="pull-right">' + $(cell).html() + '</span>');
                    }
                },

            ],
            createdRow: function (row, data, dataIndex) {
                var rowKey = "bdco=" + data.BDCo + "&bidId=" + data.BidId;
                $(row).attr('data-entitykey', rowKey);
            }
        });
    });
</script>