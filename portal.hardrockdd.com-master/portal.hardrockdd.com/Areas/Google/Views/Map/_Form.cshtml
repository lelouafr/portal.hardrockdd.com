@model portal.Areas.Google.Models.Map.MapViewModel
@using Newtonsoft.Json;

@{
    var jsonCords = JsonConvert.SerializeObject(Model.Coords, Formatting.Indented);
    var jsonTitles = JsonConvert.SerializeObject(Model.Titles, Formatting.Indented);
    var locations = JsonConvert.SerializeObject(Model.Locations, Formatting.Indented);
    var srcapi = "https://maps.googleapis.com/maps/api/js?key=AIzaSyCV9nb7_WuU9a621hnvXKFkwu9nWkHEoi8";
}
<div style="height:500px;" id="map"></div>
<script type="text/javascript">
    var geocoder;
    var map;
    var coords = @Html.Raw(jsonCords);
    var titles = @Html.Raw(jsonTitles);
    var locations = @Html.Raw(locations);
    //    [
    //    "31.744528 -101.943222"
    //];
    //var address = [
    //    "7601 West McCormick Rd, Amarillo, TX, 79114"
    //];
    //var titles = [
    //    "12 inch"];

    function addGeoMarker(location, index) {

        var pos = new google.maps.LatLng(location.Lat, location.Long);
        var infowindow = new google.maps.InfoWindow({
            content: location.Title,
        });
        var marker, i;
        //console.log("Location info:", location, index, location.Lat, location.Long, location.Title, pos);
        var marker = new google.maps.Marker({
            position: pos,
            map: map,
            title: location.Title
        });
        if (location.SetCenter == true)
            map.setCenter(pos);
        google.maps.event.addListener(marker, 'click', (function (marker, i) {
            return function () {
                infowindow.setContent(location.Title);
                infowindow.open(map, marker);
            }
        })(marker, i));
        //geocoder.geocode({ 'address': addr }, function (results, status) {
        //    if (status == google.maps.GeocoderStatus.OK) {
        //        if (status != google.maps.GeocoderStatus.ZERO_RESULTS) {
        //            map.setCenter(results[0].geometry.location);

        //            var infowindow = new google.maps.InfoWindow(
        //                {
        //                    content: '<b>' + titles[index] + '</b>',
        //                    size: new google.maps.Size(350, 50)
        //                });

        //            var marker = new google.maps.Marker({
        //                position: results[0].geometry.location,
        //                map: map,
        //                title: titles[index]
        //            });
        //            google.maps.event.addListener(marker, 'click', function () { infowindow.open(map, marker); });

        //        } else {
        //            console.log("No results found");
        //        }
        //    } else {
        //        console.log("Geocode was not successful for the following reason: " + status);
        //    }
        //});
    }

    function initialize() {
        if (locations[0] == null) {
            $('#map').hide();
            return;
        }
        if (locations[0].Lat == 0 || locations[0].Long ==0) {
            $('#map').hide();
            return;
        }

        geocoder = new google.maps.Geocoder();
        var latlng = new google.maps.LatLng(-34.397, 150.644);
        var myOptions = {
            center: latlng,
            zoomControl: true,
            mapTypeControl: false,
            mapTypeControl: false,
            zoom: 15,
            mapTypeControlOptions: { style: google.maps.MapTypeControlStyle.DROPDOWN_MENU },
            navigationControl: false,
            mapTypeId: google.maps.MapTypeId.HYBRID
        };
        map = new google.maps.Map(document.getElementById("map"), myOptions);


        if (geocoder && locations[0] != null) {
            $('#map').show();
            locations.forEach(addGeoMarker);
        }
        else {
            $('#map').hide();
        }
    }
    $(document).ready(function () {
        if (typeof google === 'object' && typeof google.maps === 'object') {
            initialize();
        }
        else {
            $.getScript('@srcapi').done(function () { initialize(); });
        }
    });
</script>